---
layout: tool
title: Recipe Generator
permalink: /tools/recipe/
---

{% lang en %}
<p style="color:var(--text-muted); margin-bottom:20px;">Create Shaped Crafting Recipes. Search for any Minecraft item.</p>
{% endlang %}
{% lang ru %}
<p style="color:var(--text-muted); margin-bottom:20px;">–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∫—Ä–∞—Ñ—Ç–∞. –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø—Ä–µ–¥–º–µ—Ç–∞–º Minecraft.</p>
{% endlang %}

<div style="display:flex; justify-content:center; gap:40px; flex-wrap:wrap; margin-bottom:30px;">
    <div>
        <h3 style="text-align:center; margin-bottom:10px;">Crafting Table</h3>
        <div style="display:grid; grid-template-columns:repeat(3, 60px); gap:4px; background:#c6c6c6; padding:10px; border-radius:4px; border:2px solid #555;">
            {% for i in (0..8) %}
            <div id="s{{i}}" class="craft-slot" data-index="{{i}}" title="Empty"></div>
            {% endfor %}
        </div>
    </div>
    <div style="display:flex; flex-direction:column; justify-content:center;">
        <i class="fa-solid fa-arrow-right" style="font-size:2rem; color:var(--text-muted);"></i>
    </div>
    <div>
        <h3 style="text-align:center; margin-bottom:10px;">Result</h3>
        <div style="background:#c6c6c6; padding:10px; border-radius:4px; border:2px solid #555; width:84px; height:84px; display:flex; align-items:center; justify-content:center;">
            <div id="res-slot" class="craft-slot" data-index="-1" style="width:60px; height:60px;"></div>
        </div>
        <input type="number" id="res-count" class="form-input" value="1" style="width:84px; margin-top:5px; text-align:center;" min="1" max="64">
    </div>
</div>

<button id="btn-gen" class="btn primary" style="width:100%;">Generate JSON</button>
<textarea id="recipe-out" class="form-area" readonly style="height:200px; font-family:monospace; margin-top:20px;"></textarea>
<button id="btn-copy" class="btn" style="width:100%; margin-top:10px;">Copy JSON</button>

<div id="picker-modal" class="item-picker-modal">
    <div class="item-picker-content">
        <div style="padding:15px; border-bottom:1px solid var(--border); display:flex; gap:10px; background: var(--bg-panel);">
            <input type="text" id="picker-search" class="form-input" placeholder="Search item..." style="flex:1;">
            <button id="btn-close-picker" class="btn">Close</button>
        </div>
        <div id="picker-loading" style="padding:20px; text-align:center; color:var(--text-muted);">Loading items...</div>
        <div id="picker-list" class="item-list" style="display:none;"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        let currentSlot = -1;
        let grid = new Array(9).fill("minecraft:air");
        let resultItem = "minecraft:diamond";
        let allItems = []; 
        
        const CACHE_KEY = 'mc_items_cache_v1_20';
        const CACHE_TIME = 7 * 24 * 60 * 60 * 1000; // 7 –¥–Ω–µ–π

        // --- DOM Elements ---
        const modal = document.getElementById('picker-modal');
        const searchInput = document.getElementById('picker-search');
        const pickerList = document.getElementById('picker-list');
        const pickerLoading = document.getElementById('picker-loading');

        // --- Init ---
        // Restore state
        const savedGrid = JSON.parse(localStorage.getItem('recipe_tool_grid'));
        if(savedGrid) {
            grid = savedGrid;
            grid.forEach((id, i) => updateSlotUI('s'+i, id));
        }
        updateSlotUI('res-slot', resultItem);

        // --- Event Listeners ---
        document.querySelectorAll('.craft-slot').forEach(slot => {
            slot.addEventListener('click', () => {
                const idx = parseInt(slot.dataset.index);
                openPicker(idx);
            });
        });

        document.getElementById('btn-gen').addEventListener('click', genRecipe);
        
        document.getElementById('btn-copy').addEventListener('click', () => {
            const el = document.getElementById('recipe-out');
            el.select();
            document.execCommand('copy');
        });

        document.getElementById('btn-close-picker').addEventListener('click', closePicker);
        
        modal.addEventListener('click', (e) => {
            if(e.target === modal) closePicker();
        });

        searchInput.addEventListener('input', (e) => renderItems(e.target.value));

        // --- Functions ---

        function openPicker(idx) {
            currentSlot = idx;
            modal.style.display = 'flex';
            searchInput.value = '';
            searchInput.focus();
            
            if (allItems.length === 0) fetchItems();
            else renderItems('');
        }

        function closePicker() { 
            modal.style.display = 'none'; 
        }

        async function fetchItems() {
            // 1. Try Cache
            const cached = localStorage.getItem(CACHE_KEY);
            if (cached) {
                try {
                    const parsed = JSON.parse(cached);
                    if (Date.now() - parsed.timestamp < CACHE_TIME) {
                        allItems = parsed.data;
                        pickerLoading.style.display = 'none';
                        pickerList.style.display = 'grid';
                        renderItems('');
                        return;
                    }
                } catch(e) { console.warn("Cache invalid"); }
            }

            // 2. Fetch Network
            try {
                const res = await fetch('https://raw.githubusercontent.com/PrismarineJS/minecraft-data/master/data/pc/1.20/items.json');
                const data = await res.json();
                allItems = data.map(i => ({ name: i.name, displayName: i.displayName }));
                
                // Save Cache
                localStorage.setItem(CACHE_KEY, JSON.stringify({
                    timestamp: Date.now(),
                    data: allItems
                }));
                
                pickerLoading.style.display = 'none';
                pickerList.style.display = 'grid';
                renderItems('');
            } catch (e) {
                pickerLoading.textContent = "Failed to load items. Check internet.";
                console.error(e);
            }
        }

        function renderItems(filter) {
            pickerList.innerHTML = '';
            const q = filter.toLowerCase();

            // Air option
            if(q === '' || 'air'.includes(q)) {
                const airDiv = document.createElement('div');
                airDiv.className = 'item-option';
                airDiv.innerHTML = '<span>üö´ Air</span>';
                airDiv.onclick = () => selectItem('minecraft:air');
                pickerList.appendChild(airDiv);
            }

            let count = 0;
            for (const item of allItems) {
                if (count > 100) break;
                if (item.name.includes(q) || item.displayName.toLowerCase().includes(q)) {
                    const div = document.createElement('div');
                    div.className = 'item-option';
                    div.innerHTML = `
                        <img src="https://assets.mcasset.cloud/1.20.1/assets/minecraft/textures/item/${item.name}.png" 
                             onerror="this.src='https://assets.mcasset.cloud/1.20.1/assets/minecraft/textures/block/${item.name}.png'; this.onerror=()=>this.style.opacity=0.3">
                        <span>${item.displayName}</span>
                    `;
                    div.title = "minecraft:" + item.name;
                    div.onclick = () => selectItem("minecraft:" + item.name);
                    pickerList.appendChild(div);
                    count++;
                }
            }
        }

        function selectItem(id) {
            if(currentSlot === -1) { 
                resultItem = id; 
                updateSlotUI('res-slot', id); 
            } else { 
                grid[currentSlot] = id; 
                updateSlotUI('s' + currentSlot, id); 
            }
            closePicker();
            saveState();
        }

        function updateSlotUI(elId, id) {
            const el = document.getElementById(elId);
            const name = id.replace('minecraft:', '');
            
            if (id === 'minecraft:air') {
                el.innerHTML = '';
                el.title = 'Empty';
                return;
            }

            el.innerHTML = `<img src="https://assets.mcasset.cloud/1.20.1/assets/minecraft/textures/item/${name}.png" onerror="this.src='https://assets.mcasset.cloud/1.20.1/assets/minecraft/textures/block/${name}.png'">`;
            el.title = id;
        }

        function genRecipe() {
            const keys = {};
            const chars = "ABCDEFGHI";
            const pattern = ["", "", ""];
            let keyIdx = 0;
            
            grid.forEach((item, i) => {
                const row = Math.floor(i/3);
                if(item === 'minecraft:air') {
                    pattern[row] += " ";
                } else {
                    let char = Object.keys(keys).find(k => keys[k].item === item);
                    if(!char) { 
                        char = chars[keyIdx++]; 
                        keys[char] = { item: item }; 
                    }
                    pattern[row] += char;
                }
            });

            const json = { 
                type: "minecraft:crafting_shaped", 
                pattern: pattern, 
                key: keys, 
                result: { 
                    item: resultItem, 
                    count: parseInt(document.getElementById('res-count').value) 
                } 
            };
            document.getElementById('recipe-out').value = JSON.stringify(json, null, 4);
        }

        function saveState() {
            localStorage.setItem('recipe_tool_grid', JSON.stringify(grid));
            localStorage.setItem('recipe_tool_res', resultItem);
        }
    });
</script>

}
